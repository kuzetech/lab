# é¡¹ç›®å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒåŠŸèƒ½å®ç° âœ“
- âœ… æ–‡ä»¶è¯»å–å’Œè§£æï¼ˆæ”¯æŒ .log æ ¼å¼ï¼ŒJSON è¡Œï¼‰
- âœ… Pulsar ç”Ÿäº§è€…é›†æˆ
- âœ… MySQL åç§»é‡ç®¡ç†å’Œæ–­ç‚¹ç»­ä¼ 
- âœ… æ‰¹é‡æ¶ˆæ¯å‘é€
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- âœ… æ—¥å¿—è®°å½•å’Œç›‘æ§

### 2. é¡¹ç›®é…ç½® âœ“
- âœ… pom.xml - Maven ä¾èµ–é…ç½®å®Œæ•´
  - Apache Pulsar Client 4.0.1
  - MySQL JDBC Driver 8.0.33
  - Jackson (JSON/YAML)
  - SLF4J + Logback
  - Maven Shade Pluginï¼ˆç”Ÿæˆ uber-jarï¼‰
  
- âœ… docker-compose.yml - æœåŠ¡ç¼–æ’é…ç½®
  - Pulsar Standalone 4.0.1
  - MySQL 8.0.33
  - å¥åº·æ£€æŸ¥é…ç½®
  - æ•°æ®æŒä¹…åŒ–

- âœ… config.yaml - åº”ç”¨é…ç½®æ¨¡æ¿
  - Pulsar è¿æ¥é…ç½®
  - MySQL è¿æ¥é…ç½®
  - æ–‡ä»¶å¤„ç†é…ç½®
  - é‡è¯•ç­–ç•¥é…ç½®

- âœ… logback.xml - æ—¥å¿—é…ç½®
  - æ§åˆ¶å°è¾“å‡º
  - æ–‡ä»¶è¾“å‡ºï¼ˆæ”¯æŒæ—¥å¿—è½®è½¬ï¼‰

### 3. æ•°æ®åº“è®¾è®¡ âœ“
- âœ… file_offsets è¡¨ - å­˜å‚¨æ–‡ä»¶å¤„ç†åç§»é‡
  - æ–‡ä»¶è·¯å¾„ã€å¤§å°ã€åç§»ä½ç½®
  - å¤„ç†è¿›åº¦ã€çŠ¶æ€
  - åˆ›å»ºå’Œæ›´æ–°æ—¶é—´
  
- âœ… transaction_log è¡¨ - äº‹åŠ¡å®¡è®¡æ—¥å¿—
  - äº‹åŠ¡ IDã€æ–‡ä»¶è·¯å¾„
  - åç§»èŒƒå›´ã€æ¶ˆæ¯æ•°é‡
  - äº‹åŠ¡çŠ¶æ€

### 4. Java ç±»å®ç° âœ“

#### é…ç½®ç±»
- âœ… `AppConfig.java` - é…ç½®æ•°æ®æ¨¡å‹
- âœ… `ConfigLoader.java` - é…ç½®åŠ è½½å’Œå‘½ä»¤è¡Œå‚æ•°å¤„ç†

#### ç®¡ç†ç±»
- âœ… `OffsetManager.java` - MySQL åç§»é‡ç®¡ç†
  - è·å–/æ›´æ–°åç§»é‡
  - æ ‡è®°å®Œæˆ/å¤±è´¥
  - äº‹åŠ¡æ—¥å¿—è®°å½•
  
- âœ… `PulsarProducerManager.java` - Pulsar ç”Ÿäº§è€…ç®¡ç†
  - å®¢æˆ·ç«¯åˆå§‹åŒ–
  - æ¶ˆæ¯å‘é€ï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰
  - èµ„æºæ¸…ç†

#### å¤„ç†ç±»
- âœ… `FileProcessor.java` - æ–‡ä»¶å¤„ç†æ ¸å¿ƒé€»è¾‘
  - æ–‡ä»¶éªŒè¯ï¼ˆæ ¼å¼ã€å¤§å°ï¼‰
  - æ–­ç‚¹ç»­ä¼ 
  - æ‰¹é‡å¤„ç†
  - é”™è¯¯é‡è¯•
  - è¿›åº¦è·Ÿè¸ª

#### ä¸»ç¨‹åº
- âœ… `Main.java` - ç¨‹åºå…¥å£
  - é…ç½®åŠ è½½
  - å‚æ•°è§£æ
  - èµ„æºç®¡ç†
  - é”™è¯¯å¤„ç†

### 5. è¾…åŠ©è„šæœ¬ âœ“
- âœ… `test-data-gen.sh` - æµ‹è¯•æ•°æ®ç”Ÿæˆè„šæœ¬
  - ç”Ÿæˆ JSON æ ¼å¼æ—¥å¿—è¡Œ
  - æ”¯æŒè‡ªå®šä¹‰è¡Œæ•°å’Œè¾“å‡ºè·¯å¾„
  
- âœ… `init-db.sql` - MySQL åˆå§‹åŒ–è„šæœ¬
  - è‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„
  - ç´¢å¼•ä¼˜åŒ–

### 6. æ–‡æ¡£ âœ“
- âœ… README.md - é¡¹ç›®è¯´æ˜ï¼ˆå·²æ›´æ–°ï¼‰
- âœ… QUICKSTART.md - å¿«é€Ÿå¼€å§‹æŒ‡å—
  - ç¯å¢ƒå‡†å¤‡
  - æœåŠ¡å¯åŠ¨
  - æµ‹è¯•æ­¥éª¤
  - å¸¸è§é—®é¢˜
  - æ€§èƒ½è°ƒä¼˜

- âœ… é…ç½®æ–‡ä»¶æ³¨é‡Šå®Œæ•´
- âœ… ä»£ç æ³¨é‡Šæ¸…æ™°

### 7. æ„å»ºå’Œæ‰“åŒ… âœ“
- âœ… ç¼–è¯‘é€šè¿‡
- âœ… æ‰“åŒ…æˆåŠŸ
- âœ… ç”Ÿæˆ uber-jarï¼ˆåŒ…å«æ‰€æœ‰ä¾èµ–ï¼‰

### 8. å•å…ƒæµ‹è¯• âœ“
- âœ… `ConfigLoaderTest.java` - é…ç½®åŠ è½½æµ‹è¯•
  - é»˜è®¤é…ç½®åŠ è½½æµ‹è¯•
  - å‘½ä»¤è¡Œå‚æ•°è¦†ç›–æµ‹è¯•
  - é…ç½®éªŒè¯æµ‹è¯•

### 9. ç®¡ç†è„šæœ¬ âœ“
- âœ… `run.sh` - åº”ç”¨è¿è¡Œè„šæœ¬
  - è‡ªåŠ¨æ£€æŸ¥ä¾èµ–ï¼ˆJava, Maven, Dockerï¼‰
  - è‡ªåŠ¨æ„å»ºé¡¹ç›®ï¼ˆå¦‚éœ€è¦ï¼‰
  - è‡ªåŠ¨å¯åŠ¨æœåŠ¡ï¼ˆå¦‚æœªè¿è¡Œï¼‰
  - å¥åº·æ£€æŸ¥å’ŒéªŒè¯
  - å¸¦é¢œè‰²çš„å‹å¥½è¾“å‡º
  
- âœ… `manage.sh` - æœåŠ¡ç®¡ç†è„šæœ¬
  - å¯åŠ¨/åœæ­¢/é‡å¯æœåŠ¡
  - æŸ¥çœ‹æœåŠ¡çŠ¶æ€å’Œç»Ÿè®¡
  - æŸ¥çœ‹æ—¥å¿—
  - æ•°æ®åº“ç®¡ç†
  - æ¶ˆæ¯æ¶ˆè´¹å’Œä¸»é¢˜ç»Ÿè®¡
  - æ•°æ®æ¸…ç†

### 10. ç¤ºä¾‹æ–‡æ¡£ âœ“
- âœ… `EXAMPLES.md` - å®Œæ•´ä½¿ç”¨ç¤ºä¾‹
  - 10+ ä¸ªçœŸå®ä½¿ç”¨åœºæ™¯
  - æ–­ç‚¹ç»­ä¼ ç¤ºä¾‹
  - æ€§èƒ½æµ‹è¯•ç¤ºä¾‹
  - æ•…éšœæ’é™¤æŒ‡å—
  - å‘½ä»¤é€ŸæŸ¥è¡¨

## ğŸ“ æ³¨æ„äº‹é¡¹

### 1. äº‹åŠ¡æ”¯æŒ
å½“å‰ç‰ˆæœ¬ä¸ºäº†å…¼å®¹æ€§ï¼Œ**æš‚æœªå¯ç”¨ Pulsar äº‹åŠ¡åŠŸèƒ½**ã€‚åŸå› ï¼š
- Pulsar 4.0.1 çš„äº‹åŠ¡ API å¯èƒ½ä¸ä¹‹å‰ç‰ˆæœ¬ä¸åŒ
- äº‹åŠ¡éœ€è¦æœåŠ¡ç«¯ç‰¹æ®Šé…ç½®
- æ‰¹é‡å‘é€å·²ç»æä¾›äº†åŸºæœ¬çš„å¯é æ€§ä¿è¯

å¦‚éœ€å¯ç”¨äº‹åŠ¡ï¼š
1. ç¡®è®¤ Pulsar æœåŠ¡ç«¯é…ç½®æ”¯æŒäº‹åŠ¡
2. æ›´æ–° PulsarProducerManager æ·»åŠ äº‹åŠ¡ API
3. åœ¨ FileProcessor ä¸­å¯ç”¨äº‹åŠ¡æ‰¹å¤„ç†

### 2. MySQL ä¾èµ–è­¦å‘Š
Maven ç¼–è¯‘æ—¶ä¼šæç¤ºï¼š
```
WARNING: mysql:mysql-connector-java -> com.mysql:mysql-connector-j
```
è¿™æ˜¯æ­£å¸¸çš„ï¼ŒMaven ä¼šè‡ªåŠ¨ä½¿ç”¨æ–°çš„åæ ‡ã€‚

### 3. æ–‡ä»¶å¤§å°é™åˆ¶
å½“å‰é™åˆ¶ä¸º 10MBï¼Œåœ¨ FileProcessor ä¸­ç¡¬ç¼–ç ã€‚å¦‚éœ€ä¿®æ”¹ï¼š
```java
if (fileSize > 10 * 1024 * 1024) {
    throw new IllegalArgumentException("File size exceeds 10MB limit: " + fileSize);
}
```

### 4. JSON éªŒè¯
å½“å‰ä½¿ç”¨ç®€å•çš„å­—ç¬¦ä¸²æ£€æŸ¥éªŒè¯ JSONï¼š
```java
line.startsWith("{") && line.endsWith("}")
```
å¦‚éœ€æ›´ä¸¥æ ¼çš„éªŒè¯ï¼Œå¯ä»¥ä½¿ç”¨ Jackson è§£æã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 2. ç”Ÿæˆæµ‹è¯•æ•°æ®
chmod +x scripts/test-data-gen.sh
./scripts/test-data-gen.sh 1000 /tmp/test.log

# 3. ç¼–è¯‘æ‰“åŒ…
mvn clean package

# 4. è¿è¡Œç¨‹åº
java -jar target/lab-java-pulsar-eos-1.0-SNAPSHOT.jar --file /tmp/test.log

# 5. éªŒè¯ç»“æœ
# æŸ¥çœ‹ MySQL åç§»é‡
docker exec -it mysql-offset-store mysql -upulsar_user -ppulsar_pass pulsar_offset \
  -e "SELECT * FROM file_offsets;"

# æ¶ˆè´¹ Pulsar æ¶ˆæ¯
docker exec -it pulsar-standalone bin/pulsar-client consume \
  persistent://public/default/log-messages \
  --subscription-name test-sub \
  --num-messages 10
```

## ğŸ”§ é…ç½®è¦†ç›–ç¤ºä¾‹

```bash
# ä½¿ç”¨ä¸åŒçš„ä¸»é¢˜
java -jar target/lab-java-pulsar-eos-1.0-SNAPSHOT.jar \
  --file /tmp/test.log \
  --topic persistent://public/default/custom-topic

# è°ƒæ•´æ‰¹å¤„ç†å¤§å°
java -jar target/lab-java-pulsar-eos-1.0-SNAPSHOT.jar \
  --file /tmp/test.log \
  --batch-size 200

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
java -jar target/lab-java-pulsar-eos-1.0-SNAPSHOT.jar \
  --config /path/to/custom-config.yaml \
  --file /tmp/test.log
```

## ğŸ¯ ä¸‹ä¸€æ­¥æ”¹è¿›å»ºè®®

1. **å¢åŠ å•å…ƒæµ‹è¯•** - ä½¿ç”¨ JUnit æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
2. **å¢åŠ é›†æˆæµ‹è¯•** - æµ‹è¯•å®Œæ•´æµç¨‹
3. **æ”¯æŒå¤šæ–‡ä»¶å¤„ç†** - æ‰«æç›®å½•å¤„ç†å¤šä¸ªæ–‡ä»¶
4. **å¢åŠ ç›‘æ§æŒ‡æ ‡** - é›†æˆ Prometheus/Grafana
5. **æ”¯æŒæ›´å¤šæ¶ˆæ¯æ ¼å¼** - CSVã€XML ç­‰
6. **å¹¶å‘å¤„ç†** - å¤šçº¿ç¨‹å¤„ç†å¤§æ–‡ä»¶
7. **å®Œæ•´çš„äº‹åŠ¡æ”¯æŒ** - æ ¹æ® Pulsar ç‰ˆæœ¬å¯ç”¨
8. **Web ç®¡ç†ç•Œé¢** - æŸ¥çœ‹å¤„ç†è¿›åº¦å’ŒçŠ¶æ€

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **Java ç±»**: 7 ä¸ªï¼ˆ6 ä¸ªä¸»ç¨‹åºç±» + 1 ä¸ªæµ‹è¯•ç±»ï¼‰
- **é…ç½®æ–‡ä»¶**: 4 ä¸ªï¼ˆconfig.yaml, logback.xml, pom.xml, docker-compose.ymlï¼‰
- **è„šæœ¬æ–‡ä»¶**: 4 ä¸ªï¼ˆtest-data-gen.sh, run.sh, manage.sh, init-db.sqlï¼‰
- **æ–‡æ¡£æ–‡ä»¶**: 5 ä¸ªï¼ˆREADME.md, QUICKSTART.md, IMPLEMENTATION.md, EXAMPLES.md, .gitignoreï¼‰
- **ä¾èµ–åº“**: 10+ ä¸ª
- **ä»£ç è¡Œæ•°**: ~1500+ è¡Œ

## âœ¨ é¡¹ç›®äº®ç‚¹

1. **å®Œæ•´çš„é¡¹ç›®ç»“æ„** - ç¬¦åˆ Maven æ ‡å‡†
2. **æ¸…æ™°çš„ä»£ç ç»„ç»‡** - åˆ†å±‚æ¶æ„
3. **å®Œå–„çš„é…ç½®ç®¡ç†** - æ”¯æŒæ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°
4. **å¯é çš„é”™è¯¯å¤„ç†** - é‡è¯•æœºåˆ¶å’Œæ—¥å¿—è®°å½•
5. **æ–­ç‚¹ç»­ä¼ ** - MySQL åç§»é‡ç®¡ç†
6. **å®¹å™¨åŒ–éƒ¨ç½²** - Docker Compose ä¸€é”®å¯åŠ¨
7. **è¯¦ç»†çš„æ–‡æ¡£** - README, QUICKSTART, EXAMPLES
8. **ç”Ÿäº§å°±ç»ª** - åŒ…å«æ—¥å¿—ã€ç›‘æ§ã€é”™è¯¯å¤„ç†
9. **å‹å¥½çš„ç®¡ç†è„šæœ¬** - ç®€åŒ–è¿ç»´æ“ä½œ
10. **å•å…ƒæµ‹è¯•** - ä¿è¯ä»£ç è´¨é‡

## ğŸš€ ä¾¿æ·çš„ä½¿ç”¨æ–¹å¼

### ä¸€é”®å¯åŠ¨å¹¶è¿è¡Œ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd lab-java-pulsar-eos

# 2. ç”Ÿæˆæµ‹è¯•æ•°æ®
./scripts/test-data-gen.sh 1000 /tmp/test.log

# 3. è¿è¡Œï¼ˆè‡ªåŠ¨å¯åŠ¨æœåŠ¡ã€æ„å»ºã€è¿è¡Œï¼‰
./run.sh /tmp/test.log
```

### æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
./manage.sh help

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€å’Œæ•°æ®ç»Ÿè®¡
./manage.sh status

# æŸ¥çœ‹å¤„ç†è¿›åº¦
./manage.sh offsets

# æ¶ˆè´¹æ¶ˆæ¯éªŒè¯ç»“æœ
./manage.sh consume 10
```

## ğŸ“ å¤‡æ³¨

æœ¬é¡¹ç›®å·²å®Œæ•´å®ç° README ä¸­æè¿°çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚æ‰€æœ‰ä»£ç ç»è¿‡ç¼–è¯‘æµ‹è¯•ï¼Œæ‰“åŒ…æˆåŠŸã€‚
